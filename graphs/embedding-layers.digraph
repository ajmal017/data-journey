digraph { 
"tf(0)$0" -> "tf(0)" [label = "set_random_seed"]
"tf(0)$0" -> "1(0)" [label = "set_random_seed"]
"np(0)$0" -> "np(0)" [label = "seed"]
"np(0)$0" -> "1(0)" [label = "seed"]
"random(0)$0" -> "random(0)" [label = "seed"]
"random(0)$0" -> "1(0)" [label = "seed"]
"input_dir(0)$0" -> "../input(0)" [label = "eq"]
"ratings_path(0)$0" -> "os(0)" [label = "join"]
"ratings_path(0)$0" -> "input_dir(0)$0" [label = "join"]
"ratings_path(0)$0" -> "rating.csv(0)" [label = "join"]
"ratings_df(0)$0" -> "pd(0)" [label = "read_csv"]
"ratings_df(0)$0" -> "ratings_path(0)$0" [label = "read_csv"]
"ratings_df(0)$0" -> "[<_ast.Str object at 0x10cad39d0>, <_ast.Str object at 0x10c8da310>, <_ast.Str object at 0x10c8dabd0>, <_ast.Str object at 0x10c8c6590>](0)" [label = "read_csv"]
"movies_df(0)$0" -> "pd(0)" [label = "read_csv"]
"movies_df(0)$0" -> "os(0)" [label = "read_csv"]
"movies_df(0)$0" -> "input_dir(0)$0" [label = "read_csv"]
"movies_df(0)$0" -> "movie.csv(0)" [label = "read_csv"]
"movies_df(0)$0" -> "[<_ast.Str object at 0x10ca7ef10>, <_ast.Str object at 0x10ca7e150>, <_ast.Str object at 0x10ca7e990>](0)" [label = "read_csv"]
"df(0)$0" -> "ratings_df(0)$0" [label = "sort_values"]
"df(0)$0" -> "movies_df(0)$0" [label = "sort_values"]
"df(0)$0" -> "movieId(0)" [label = "sort_values"]
"df(0)$0" -> "userId(0)" [label = "sort_values"]
"df(0)$1" -> "df(0)$0" [label = "sample"]
"df(0)$1" -> "1(0)" [label = "sample"]
"df(0)$1" -> "1(0)" [label = "sample"]
"df(0)$2" -> "df(0)$1" [label = "sample"]
"df(0)$2" -> "5(0)" [label = "sample"]
"n_movies(0)$0" -> "df(0)$2" [label = "len"]
"n_users(0)$0" -> "df(0)$2" [label = "len"]
"print[0]" -> "{1:,} distinct users rated {0:,} different movies (total ratings = {2:,})(0)" [label = "print"]
"print[1]" -> "n_movies(0)$0" [label = "print"]
"print[2]" -> "n_users(0)$0" [label = "print"]
"print[3]" -> "len(0)" [label = "print"]
"print[4]" -> "df(0)$2" [label = "print"]
"model(0)$0" -> "keras(0)" [label = "Sequential"]
"model(0)$0" -> "[<_ast.Call object at 0x10ca3ae50>, <_ast.Call object at 0x10ca3afd0>, <_ast.Call object at 0x10cb8b6d0>](0)" [label = "Sequential"]
"input_size(0)$0" -> "n_movies(0)$0" [label = "Add"]
"input_size(0)$0" -> "n_users(0)$0" [label = "Add"]
"print[0]" -> "Input size = {:,} ({:,} movies + {:,} users)(0)" [label = "print"]
"print[1]" -> "input_size(0)$0" [label = "print"]
"print[2]" -> "n_movies(0)$0" [label = "print"]
"print[3]" -> "n_users(0)$0" [label = "print"]
"model(0)$1" -> "keras(0)" [label = "Sequential"]
"model(0)$1" -> "[<_ast.Call object at 0x10cb8bdd0>, <_ast.Call object at 0x10cb8bd90>](0)" [label = "Sequential"]
"model(0)$2" -> "model(0)$1" [label = "summary"]
"hidden_units(0)$0" -> "32(0)" [label = "eq"]
"hidden_units(0)$0" -> "4(0)" [label = "eq"]
"movie_embedding_size(0)$0" -> "8(0)" [label = "eq"]
"user_embedding_size(0)$0" -> "8(0)" [label = "eq"]
"user_id_input(0)$0" -> "keras(0)" [label = "Input"]
"user_id_input(0)$0" -> "1(0)" [label = "Input"]
"user_id_input(0)$0" -> "user_id(0)" [label = "Input"]
"movie_id_input(0)$0" -> "keras(0)" [label = "Input"]
"movie_id_input(0)$0" -> "1(0)" [label = "Input"]
"movie_id_input(0)$0" -> "movie_id(0)" [label = "Input"]
"user_embedded(0)$0" -> "keras(0)" [label = "eq"]
"user_embedded(0)$0" -> "df(0)$2" [label = "eq"]
"user_embedded(0)$0" -> "1(0)" [label = "eq"]
"user_embedded(0)$0" -> "user_embedding_size(0)$0" [label = "eq"]
"user_embedded(0)$0" -> "1(0)" [label = "eq"]
"user_embedded(0)$0" -> "user_embedding(0)" [label = "eq"]
"user_embedded(0)$0" -> "user_id_input(0)$0" [label = "eq"]
"movie_embedded(0)$0" -> "keras(0)" [label = "eq"]
"movie_embedded(0)$0" -> "df(0)$2" [label = "eq"]
"movie_embedded(0)$0" -> "1(0)" [label = "eq"]
"movie_embedded(0)$0" -> "movie_embedding_size(0)$0" [label = "eq"]
"movie_embedded(0)$0" -> "1(0)" [label = "eq"]
"movie_embedded(0)$0" -> "movie_embedding(0)" [label = "eq"]
"movie_embedded(0)$0" -> "movie_id_input(0)$0" [label = "eq"]
"concatenated(0)$0" -> "keras(0)" [label = "eq"]
"concatenated(0)$0" -> "[<_ast.Name object at 0x10cbb92d0>, <_ast.Name object at 0x10cbb9490>](0)" [label = "eq"]
"out(0)$0" -> "keras(0)" [label = "eq"]
"out(0)$0" -> "concatenated(0)$0" [label = "eq"]
"n_hidden(0)" -> "hidden_units(0)$0" [label = "Iter"]
"out(0)$1" -> "keras(0)" [label = "eq"]
"out(0)$1" -> "n_hidden(0)" [label = "eq"]
"out(0)$1" -> "relu(0)" [label = "eq"]
"out(0)$1" -> "out(0)$1" [label = "eq"]
"out(0)$2" -> "keras(0)" [label = "eq"]
"out(0)$2" -> "1(0)" [label = "eq"]
"out(0)$2" -> "linear(0)" [label = "eq"]
"out(0)$2" -> "prediction(0)" [label = "eq"]
"out(0)$2" -> "out(0)$2" [label = "eq"]
"model(0)$3" -> "keras(0)" [label = "Model"]
"model(0)$3" -> "[<_ast.Name object at 0x10cbb9c50>, <_ast.Name object at 0x10cbb9850>](0)" [label = "Model"]
"model(0)$3" -> "out(0)$2" [label = "Model"]
"model(0)$4" -> "model(0)$3" [label = "summary"]
"model(0)$5" -> "model(0)$4" [label = "compile"]
"model(0)$5" -> "tf(0)$0" [label = "compile"]
"model(0)$5" -> "0.005(0)" [label = "compile"]
"history(0)$0" -> "model(0)$5" [label = "fit"]
"history(0)$0" -> "[<_ast.Attribute object at 0x10ca74fd0>, <_ast.Attribute object at 0x10ca74a10>](0)" [label = "fit"]
"history(0)$0" -> "df(0)$2" [label = "fit"]
"history(0)$0" -> "5000(0)" [label = "fit"]
"history(0)$0" -> "20(0)" [label = "fit"]
"history(0)$0" -> "0(0)" [label = "fit"]
"history(0)$0" -> "0.05(0)" [label = "fit"]
"df_train(0)$0" -> "df(0)$2" [label = "train_test_split"]
"df_val(0)$0" -> "df(0)$2" [label = "train_test_split"]
"df_train(0)$0" -> "0.05(0)" [label = "train_test_split"]
"df_val(0)$0" -> "0.05(0)" [label = "train_test_split"]
"df_train(0)$0" -> "1(0)" [label = "train_test_split"]
"df_val(0)$0" -> "1(0)" [label = "train_test_split"]
"y_true(1)" -> "get_metrics[0]" [label = "_argToVar"]
"y_pred(1)" -> "get_metrics[1]" [label = "_argToVar"]
"mean_rating(0)$0" -> "df_train(0)$0" [label = "mean"]
"mean_rating(0)$0" -> "rating(0)" [label = "mean"]
"print[0]" -> "Average rating in training set is {:.2f} stars(0)" [label = "print"]
"print[1]" -> "mean_rating(0)$0" [label = "print"]
"y_true(0)$0" -> "df_val(0)$0" [label = "eq"]
"y_true(0)$0" -> "rating(0)" [label = "eq"]
"always_mean(0)$0" -> "np(0)$0" [label = "full"]
"always_mean(0)$0" -> "y_true(0)$0" [label = "full"]
"always_mean(0)$0" -> "mean_rating(0)$0" [label = "full"]
"mae(0)$0" -> "y_true(0)$0" [label = "get_metrics"]
"mse(0)$0" -> "y_true(0)$0" [label = "get_metrics"]
"mae(0)$0" -> "always_mean(0)$0" [label = "get_metrics"]
"mse(0)$0" -> "always_mean(0)$0" [label = "get_metrics"]
"print[0]" -> "Always predicting global average rating results in Mean Absolute Error={:.2f}, Mean Squared Error={:.2f}(0)" [label = "print"]
"print[1]" -> "mae(0)$0" [label = "print"]
"print[2]" -> "mse(0)$0" [label = "print"]
"movies(0)$0" -> "movies_df(0)$0" [label = "set_index"]
"movies(0)$0" -> "movieId(0)" [label = "set_index"]
"mean_per_movie(0)$0" -> "df_train(0)$0" [label = "mean"]
"mean_per_movie(0)$0" -> "movieId(0)" [label = "mean"]
"mean_per_movie(0)$0" -> "rating(0)" [label = "mean"]
"movies(0)$1" -> "movies(0)$0" [label = "eq"]
"movies(0)$1" -> "mean_per_movie(0)$0" [label = "eq"]
"ratings_per_movie(0)$0" -> "df_train(0)$0" [label = "size"]
"ratings_per_movie(0)$0" -> "movieId(0)" [label = "size"]
"movies(0)$2" -> "movies(0)$1" [label = "eq"]
"movies(0)$2" -> "ratings_per_movie(0)$0" [label = "eq"]
"y_movie_mean(0)$0" -> "df_val(0)$0" [label = "eq"]
"y_movie_mean(0)$0" -> "mean_per_movie(0)$0" [label = "eq"]
"y_movie_mean(0)$0" -> "movieId(0)" [label = "eq"]
"y_movie_mean(0)$0" -> "mean(0)" [label = "eq"]
"y_movie_mean(0)$0" -> "ratingmean(0)" [label = "eq"]
"y_movie_mean(0)$0" -> "mean_rating(0)$0" [label = "eq"]
"mae(0)$1" -> "y_true(0)$0" [label = "get_metrics"]
"mse(0)$1" -> "y_true(0)$0" [label = "get_metrics"]
"mae(0)$1" -> "y_movie_mean(0)$0" [label = "get_metrics"]
"mse(0)$1" -> "y_movie_mean(0)$0" [label = "get_metrics"]
"print[0]" -> "Predicting mean per movie results in Mean Absolute Error={:.2f}, Mean Squared Error={:.2f}(0)" [label = "print"]
"print[1]" -> "mae(0)$1" [label = "print"]
"print[2]" -> "mse(0)$1" [label = "print"]
"fig(0)$0" -> "plt(0)" [label = "subplots"]
"ax(0)$0" -> "plt(0)" [label = "subplots"]
"fig(0)$0" -> "15(0)" [label = "subplots"]
"ax(0)$0" -> "15(0)" [label = "subplots"]
"fig(0)$0" -> "6(0)" [label = "subplots"]
"ax(0)$0" -> "6(0)" [label = "subplots"]
"ax(0)$1" -> "ax(0)$0" [label = "plot"]
"ax(0)$1" -> "history(0)$0" [label = "plot"]
"ax(0)$1" -> "history(0)$0" [label = "plot"]
"ax(0)$1" -> "val_mean_absolute_error(0)" [label = "plot"]
"ax(0)$2" -> "ax(0)$1" [label = "plot"]
"ax(0)$2" -> "history(0)$0" [label = "plot"]
"ax(0)$2" -> "history(0)$0" [label = "plot"]
"ax(0)$2" -> "mean_absolute_error(0)" [label = "plot"]
"ax(0)$3" -> "ax(0)$2" [label = "set_xlabel"]
"ax(0)$3" -> "Epoch(0)" [label = "set_xlabel"]
"ax(0)$4" -> "ax(0)$3" [label = "set_ylabel"]
"ax(0)$4" -> "Mean Absolute Error(0)" [label = "set_ylabel"]
"ax(0)$5" -> "ax(0)$4" [label = "set_xlim"]
"baseline_mae(0)$0" -> "0.73(0)" [label = "eq"]
"ax(0)$6" -> "ax(0)$5" [label = "axhline"]
"ax(0)$6" -> "baseline_mae(0)$0" [label = "axhline"]
"ax(0)$7" -> "ax(0)$6" [label = "grid"]
"fig(0)$1" -> "fig(0)$0" [label = "legend"]
"hdf(0)$0" -> "pd(0)" [label = "DataFrame"]
"hdf(0)$0" -> "dict(0)" [label = "DataFrame"]
"hdf(0)$0" -> "history(0)$0" [label = "DataFrame"]
"hdf(0)$0" -> "history(0)$0" [label = "DataFrame"]
"hdf(0)$0" -> "val_mean_absolute_error(0)" [label = "DataFrame"]
"hdf(0)$0" -> "history(0)$0" [label = "DataFrame"]
"hdf(0)$0" -> "mean_absolute_error(0)" [label = "DataFrame"]
"hdf(0)$1" -> "hdf(0)$0" [label = "to_csv"]
"hdf(0)$1" -> "history-1.csv(0)" [label = "to_csv"]
"ratings_per_user(0)$0" -> "df(0)$2" [label = "size"]
"ratings_per_user(0)$0" -> "userId(0)" [label = "size"]
"uid(0)$0" -> "ratings_per_user(0)$0" [label = "eq"]
"uid(0)$0" -> "ratings_per_user(0)$0" [label = "eq"]
"uid(0)$0" -> "30(0)" [label = "eq"]
"uid(0)$0" -> "1(0)" [label = "eq"]
"uid(0)$0" -> "1(0)" [label = "eq"]
"uid(0)$0" -> "0(0)" [label = "eq"]
"user_ratings(0)$0" -> "df(0)$2" [label = "eq"]
"user_ratings(0)$0" -> "df(0)$2" [label = "eq"]
"user_ratings(0)$0" -> "uid(0)$0" [label = "eq"]
"print[0]" -> "User #{} has rated {} movies (avg. rating = {:.1f}):(0)" [label = "print"]
"print[1]" -> "uid(0)$0" [label = "print"]
"print[2]" -> "len(0)" [label = "print"]
"print[3]" -> "user_ratings(0)$0" [label = "print"]
"print[4]" -> "user_ratings(0)$0" [label = "print"]
"print[5]" -> "rating(0)" [label = "print"]
"cols(0)$0" -> "[<_ast.Str object at 0x10cad0610>, <_ast.Str object at 0x10cad0a10>, <_ast.Str object at 0x10cad0110>, <_ast.Str object at 0x10cad0550>, <_ast.Str object at 0x10cad0750>](0)" [label = "eq"]
"candidate_movies(0)$0" -> "movies(0)$2" [label = "copy"]
"candidate_movies(0)$0" -> "movies(0)$2" [label = "copy"]
"candidate_movies(0)$0" -> "Naked Gun(0)" [label = "copy"]
"candidate_movies(0)$0" -> "movies(0)$2" [label = "copy"]
"candidate_movies(0)$0" -> "The Sisterhood of the Traveling Pants(0)" [label = "copy"]
"candidate_movies(0)$0" -> "movies(0)$2" [label = "copy"]
"candidate_movies(0)$0" -> "Lilo & Stitch(0)" [label = "copy"]
"preds(0)$0" -> "model(0)$5" [label = "predict"]
"preds(0)$0" -> "[<_ast.BinOp object at 0x10cb5a190>, <_ast.Attribute object at 0x10cb5a850>](0)" [label = "predict"]
"row(0)$0" -> "df(0)$2" [label = "eq"]
"row(0)$0" -> "0(0)" [label = "eq"]
"y_delta(0)$0" -> "row(0)$0" [label = "Sub"]
"y_delta(0)$0" -> "row(0)$0" [label = "Sub"]
"candidate_movies(0)$1" -> "candidate_movies(0)$0" [label = "Add"]
"candidate_movies(0)$1" -> "preds(0)$0" [label = "Add"]
"candidate_movies(0)$1" -> "y_delta(0)$0" [label = "Add"]
"candidate_movies(0)$2" -> "candidate_movies(0)$1" [label = "Sub"]
"candidate_movies(0)$2" -> "candidate_movies(0)$1" [label = "Sub"]
"candidate_movies(0)$2" -> "predicted_rating(0)" [label = "Sub"]
"candidate_movies(0)$2" -> "candidate_movies(0)$2" [label = "Sub"]
"candidate_movies(0)$2" -> "mean_rating(0)$0" [label = "Sub"]
"candidate_movies(0)$3" -> "candidate_movies(0)$2" [label = "sort_values"]
}