digraph { 
"os(0)$0" -> "os(0)" [label = "makedirs"]
"os(0)$0" -> "/tmp/.cache/torch/checkpoints/(0)" [label = "makedirs"]
"os(0)$1" -> "os(0)$0" [label = "listdir"]
"os(0)$1" -> "../input(0)" [label = "listdir"]
"print[0]" -> "Make sure cudnn is enabled:(0)" [label = "print"]
"print[1]" -> "torch(0)" [label = "print"]
"seed(1)" -> "seed_everything[0]" [label = "_argToVar"]
"random(1)$0" -> "random(1)" [label = "seed"]
"random(1)$0" -> "seed(1)" [label = "seed"]
"os(1)$0" -> "os(1)" [label = "str"]
"os(1)$0" -> "seed(1)" [label = "str"]
"np(1)$0" -> "np(1)" [label = "seed"]
"np(1)$0" -> "seed(1)" [label = "seed"]
"torch(1)$0" -> "torch(1)" [label = "manual_seed"]
"torch(1)$0" -> "seed(1)" [label = "manual_seed"]
"torch(1)$1" -> "torch(1)$0" [label = "manual_seed"]
"torch(1)$1" -> "seed(1)" [label = "manual_seed"]
"SEED(0)$0" -> "999(0)" [label = "eq"]
"seed_everything[0]" -> "SEED(0)$0" [label = "seed_everything"]
"base_image_dir(0)$0" -> "os(0)$1" [label = "join"]
"base_image_dir(0)$0" -> "..(0)" [label = "join"]
"base_image_dir(0)$0" -> "input/aptos2019-blindness-detection/(0)" [label = "join"]
"train_dir(0)$0" -> "os(0)$1" [label = "join"]
"train_dir(0)$0" -> "base_image_dir(0)$0" [label = "join"]
"train_dir(0)$0" -> "train_images/(0)" [label = "join"]
"df(0)$0" -> "pd(0)" [label = "read_csv"]
"df(0)$0" -> "os(0)$1" [label = "read_csv"]
"df(0)$0" -> "base_image_dir(0)$0" [label = "read_csv"]
"df(0)$0" -> "train.csv(0)" [label = "read_csv"]
"df(0)$1" -> "df(0)$0" [label = "map"]
"df(0)$1" -> "df(0)$0" [label = "map"]
"df(0)$1" -> "id_code(0)" [label = "map"]
"df(0)$1" -> "os(0)$1" [label = "map"]
"df(0)$1" -> "train_dir(0)$0" [label = "map"]
"df(0)$1" -> "{}.png(0)" [label = "map"]
"df(0)$1" -> "x(0)" [label = "map"]
"df(0)$2" -> "df(0)$1" [label = "drop"]
"df(0)$2" -> "[<_ast.Str object at 0x10d895390>](0)" [label = "drop"]
"df(0)$3" -> "df(0)$2" [label = "reset_index"]
"df(0)$3" -> "1(0)" [label = "reset_index"]
"df(0)$4" -> "df(0)$3" [label = "head"]
"df(0)$4" -> "10(0)" [label = "head"]
"len_df(0)$0" -> "df(0)$4" [label = "len"]
"print[0]" -> "There are (0)" [label = "print"]
"print[1]" -> "len_df(0)$0" [label = "print"]
"print[2]" -> " images(0)" [label = "print"]
"df(0)$5" -> "df(0)$4" [label = "hist"]
"im(0)$0" -> "Image(0)" [label = "open"]
"im(0)$0" -> "df(0)$5" [label = "open"]
"im(0)$0" -> "path(0)" [label = "open"]
"im(0)$0" -> "1(0)" [label = "open"]
"width(0)$0" -> "im(0)$0" [label = "eq"]
"height(0)$0" -> "im(0)$0" [label = "eq"]
"print[0]" -> "width(0)$0" [label = "print"]
"print[1]" -> "height(0)$0" [label = "print"]
"im(0)$1" -> "im(0)$0" [label = "show"]
"plt(0)$0" -> "plt(0)" [label = "imshow"]
"plt(0)$0" -> "np(0)" [label = "imshow"]
"plt(0)$0" -> "im(0)$1" [label = "imshow"]
"bs(0)$0" -> "64(0)" [label = "eq"]
"sz(0)$0" -> "224(0)" [label = "eq"]
"tfms(0)$0" -> "360(0)" [label = "get_transforms"]
"tfms(0)$0" -> "0(0)" [label = "get_transforms"]
"tfms(0)$0" -> "1.1(0)" [label = "get_transforms"]
"tfms(0)$0" -> "0.1(0)" [label = "get_transforms"]
"tfms(0)$0" -> "0.5(0)" [label = "get_transforms"]
"src(0)$0" -> "ImageList(0)" [label = "label_from_df"]
"src(0)$0" -> "df(0)$5" [label = "label_from_df"]
"src(0)$0" -> "./(0)" [label = "label_from_df"]
"src(0)$0" -> "path(0)" [label = "label_from_df"]
"src(0)$0" -> "0.2(0)" [label = "label_from_df"]
"src(0)$0" -> "diagnosis(0)" [label = "label_from_df"]
"src(0)$0" -> "FloatList(0)" [label = "label_from_df"]
"data(0)$0" -> "src(0)$0" [label = "normalize"]
"data(0)$0" -> "tfms(0)$0" [label = "normalize"]
"data(0)$0" -> "sz(0)$0" [label = "normalize"]
"data(0)$0" -> "ResizeMethod(0)" [label = "normalize"]
"data(0)$0" -> "zeros(0)" [label = "normalize"]
"data(0)$0" -> "bs(0)$0" [label = "normalize"]
"data(0)$0" -> "4(0)" [label = "normalize"]
"data(0)$0" -> "imagenet_stats(0)" [label = "normalize"]
"data(0)$1" -> "data(0)$0" [label = "show_batch"]
"y_hat(2)" -> "quadratic_kappa[0]" [label = "_argToVar"]
"y(2)" -> "quadratic_kappa[1]" [label = "_argToVar"]
"learn(0)$0" -> "data(0)$1" [label = "cnn_learner"]
"learn(0)$0" -> "models(0)" [label = "cnn_learner"]
"learn(0)$0" -> "[<_ast.Name object at 0x10ca7edd0>](0)" [label = "cnn_learner"]
"learn(0)$1" -> "learn(0)$0" [label = "lr_find"]
"learn(0)$2" -> "learn(0)$1" [label = "plot"]
"learn(0)$3" -> "learn(0)$2" [label = "fit_one_cycle"]
"learn(0)$3" -> "4(0)" [label = "fit_one_cycle"]
"learn(0)$4" -> "learn(0)$3" [label = "plot_losses"]
"learn(0)$5" -> "learn(0)$4" [label = "plot_metrics"]
"learn(0)$6" -> "learn(0)$5" [label = "unfreeze"]
"learn(0)$7" -> "learn(0)$6" [label = "lr_find"]
"learn(0)$8" -> "learn(0)$7" [label = "plot"]
"learn(0)$9" -> "learn(0)$8" [label = "fit_one_cycle"]
"learn(0)$9" -> "6(0)" [label = "fit_one_cycle"]
"learn(0)$10" -> "learn(0)$9" [label = "plot_losses"]
"learn(0)$11" -> "learn(0)$10" [label = "plot_metrics"]
"learn(0)$12" -> "learn(0)$11" [label = "export"]
"learn(0)$13" -> "learn(0)$12" [label = "save"]
"learn(0)$13" -> "stage-2(0)" [label = "save"]
"interp(0)$0" -> "ClassificationInterpretation(0)" [label = "from_learner"]
"interp(0)$0" -> "learn(0)$13" [label = "from_learner"]
"losses(0)$0" -> "interp(0)$0" [label = "top_losses"]
"idxs(0)$0" -> "interp(0)$0" [label = "top_losses"]
"valid_preds(0)$0" -> "learn(0)$13" [label = "get_preds"]
"valid_preds(0)$0" -> "DatasetType(0)" [label = "get_preds"]
"self(3)" -> "__init__[0]" [label = "_argToVar"]
"self(3)$0" -> "self(3)" [label = "eq"]
"self(3)$0" -> "0(3)" [label = "eq"]
"self(4)" -> "_kappa_loss[0]" [label = "_argToVar"]
"coef(4)" -> "_kappa_loss[1]" [label = "_argToVar"]
"X(4)" -> "_kappa_loss[2]" [label = "_argToVar"]
"y(4)" -> "_kappa_loss[3]" [label = "_argToVar"]
"X_p(4)$0" -> "np(4)" [label = "copy"]
"X_p(4)$0" -> "X(4)" [label = "copy"]
"i(4)" -> "enumerate(4)" [label = "Iter"]
"pred(4)" -> "enumerate(4)" [label = "Iter"]
"i(4)" -> "X_p(4)$0" [label = "Iter"]
"pred(4)" -> "X_p(4)$0" [label = "Iter"]
"X_p(4)$1" -> "X_p(4)$0" [label = "eq"]
"X_p(4)$1" -> "0(4)" [label = "eq"]
"X_p(4)$2" -> "X_p(4)$1" [label = "eq"]
"X_p(4)$2" -> "1(4)" [label = "eq"]
"X_p(4)$3" -> "X_p(4)$2" [label = "eq"]
"X_p(4)$3" -> "2(4)" [label = "eq"]
"X_p(4)$4" -> "X_p(4)$3" [label = "eq"]
"X_p(4)$4" -> "3(4)" [label = "eq"]
"X_p(4)$5" -> "X_p(4)$4" [label = "eq"]
"X_p(4)$5" -> "4(4)" [label = "eq"]
"ll(4)$0" -> "metrics(4)" [label = "cohen_kappa_score"]
"ll(4)$0" -> "y(4)" [label = "cohen_kappa_score"]
"ll(4)$0" -> "X_p(4)$5" [label = "cohen_kappa_score"]
"ll(4)$0" -> "quadratic(4)" [label = "cohen_kappa_score"]
"self(5)" -> "fit[0]" [label = "_argToVar"]
"X(5)" -> "fit[1]" [label = "_argToVar"]
"y(5)" -> "fit[2]" [label = "_argToVar"]
"loss_partial(5)$0" -> "self(5)" [label = "partial"]
"loss_partial(5)$0" -> "X(5)" [label = "partial"]
"loss_partial(5)$0" -> "y(5)" [label = "partial"]
"initial_coef(5)$0" -> "[<_ast.Num object at 0x10caa4890>, <_ast.Num object at 0x10caa4650>, <_ast.Num object at 0x10caa4110>, <_ast.Num object at 0x10caa4b10>](5)" [label = "eq"]
"self(5)$0" -> "self(5)" [label = "minimize"]
"self(5)$0" -> "sp(5)" [label = "minimize"]
"self(5)$0" -> "loss_partial(5)$0" [label = "minimize"]
"self(5)$0" -> "initial_coef(5)$0" [label = "minimize"]
"self(5)$0" -> "nelder-mead(5)" [label = "minimize"]
"print[0]" -> "loss_partial(5)$0" [label = "print"]
"print[1]" -> "self(5)$0" [label = "print"]
"print[2]" -> "x(5)" [label = "print"]
"self(6)" -> "predict[0]" [label = "_argToVar"]
"X(6)" -> "predict[1]" [label = "_argToVar"]
"coef(6)" -> "predict[2]" [label = "_argToVar"]
"X_p(6)$0" -> "np(6)" [label = "copy"]
"X_p(6)$0" -> "X(6)" [label = "copy"]
"i(6)" -> "enumerate(6)" [label = "Iter"]
"pred(6)" -> "enumerate(6)" [label = "Iter"]
"i(6)" -> "X_p(6)$0" [label = "Iter"]
"pred(6)" -> "X_p(6)$0" [label = "Iter"]
"X_p(6)$1" -> "X_p(6)$0" [label = "eq"]
"X_p(6)$1" -> "0(6)" [label = "eq"]
"X_p(6)$2" -> "X_p(6)$1" [label = "eq"]
"X_p(6)$2" -> "1(6)" [label = "eq"]
"X_p(6)$3" -> "X_p(6)$2" [label = "eq"]
"X_p(6)$3" -> "2(6)" [label = "eq"]
"X_p(6)$4" -> "X_p(6)$3" [label = "eq"]
"X_p(6)$4" -> "3(6)" [label = "eq"]
"X_p(6)$5" -> "X_p(6)$4" [label = "eq"]
"X_p(6)$5" -> "4(6)" [label = "eq"]
"self(7)" -> "coefficients[0]" [label = "_argToVar"]
"optR(0)$0" -> "optR(0)" [label = "fit"]
"optR(0)$0" -> "valid_preds(0)$0" [label = "fit"]
"optR(0)$0" -> "0(0)" [label = "fit"]
"optR(0)$0" -> "valid_preds(0)$0" [label = "fit"]
"optR(0)$0" -> "1(0)" [label = "fit"]
"coefficients(0)$0" -> "optR(0)$0" [label = "coefficients"]
"print[0]" -> "coefficients(0)$0" [label = "print"]
"learn(8)" -> "_tta_only[0]" [label = "_argToVar"]
"ds_type(8)" -> "_tta_only[1]" [label = "_argToVar"]
"num_pred(8)" -> "_tta_only[2]" [label = "_argToVar"]
"dl(8)$0" -> "learn(8)" [label = "dl"]
"dl(8)$0" -> "ds_type(8)" [label = "dl"]
"ds(8)$0" -> "dl(8)$0" [label = "eq"]
"old(8)$0" -> "ds(8)$0" [label = "eq"]
"aug_tfms(8)$0" -> "o(8)" [label = "eq"]
"aug_tfms(8)$0" -> "o(8)" [label = "eq"]
"aug_tfms(8)$0" -> "learn(8)" [label = "eq"]
"pbar(8)$0" -> "range(8)" [label = "master_bar"]
"pbar(8)$0" -> "num_pred(8)" [label = "master_bar"]
"i(8)" -> "pbar(8)$0" [label = "Iter"]
"ds(8)$1" -> "ds(8)$0" [label = "eq"]
"ds(8)$1" -> "aug_tfms(8)$0" [label = "eq"]
"ds(8)$2" -> "ds(8)$1" [label = "eq"]
"ds(8)$2" -> "old(8)$0" [label = "eq"]
"Learner(0)$0" -> "Learner(0)" [label = "eq"]
"Learner(0)$0" -> "_tta_only(0)" [label = "eq"]
"learn(9)" -> "_TTA[0]" [label = "_argToVar"]
"beta(9)" -> "_TTA[1]" [label = "_argToVar"]
"ds_type(9)" -> "_TTA[2]" [label = "_argToVar"]
"num_pred(9)" -> "_TTA[3]" [label = "_argToVar"]
"with_loss(9)" -> "_TTA[4]" [label = "_argToVar"]
"preds(9)$0" -> "learn(9)" [label = "get_preds"]
"y(9)$0" -> "learn(9)" [label = "get_preds"]
"preds(9)$0" -> "ds_type(9)" [label = "get_preds"]
"y(9)$0" -> "ds_type(9)" [label = "get_preds"]
"all_preds(9)$0" -> "learn(9)" [label = "list"]
"all_preds(9)$0" -> "ds_type(9)" [label = "list"]
"all_preds(9)$0" -> "num_pred(9)" [label = "list"]
"avg_preds(9)$0" -> "torch(9)" [label = "mean"]
"avg_preds(9)$0" -> "all_preds(9)$0" [label = "mean"]
"avg_preds(9)$0" -> "0(9)" [label = "mean"]
"final_preds(9)$0" -> "preds(9)$0" [label = "Add"]
"final_preds(9)$0" -> "beta(9)" [label = "Add"]
"final_preds(9)$0" -> "avg_preds(9)$0" [label = "Add"]
"final_preds(9)$0" -> "1(9)" [label = "Add"]
"final_preds(9)$0" -> "beta(9)" [label = "Add"]
"loss(9)$0" -> "final_preds(9)$0" [label = "lf"]
"loss(9)$0" -> "y(9)$0" [label = "lf"]
"Learner(0)$1" -> "Learner(0)$0" [label = "eq"]
"Learner(0)$1" -> "_TTA(0)" [label = "eq"]
"sample_df(0)$0" -> "pd(0)" [label = "read_csv"]
"sample_df(0)$0" -> "../input/aptos2019-blindness-detection/sample_submission.csv(0)" [label = "read_csv"]
"sample_df(0)$1" -> "sample_df(0)$0" [label = "head"]
"learn(0)$14" -> "learn(0)$13" [label = "add_test"]
"learn(0)$14" -> "ImageList(0)" [label = "add_test"]
"learn(0)$14" -> "sample_df(0)$1" [label = "add_test"]
"learn(0)$14" -> "../input/aptos2019-blindness-detection(0)" [label = "add_test"]
"learn(0)$14" -> "test_images(0)" [label = "add_test"]
"learn(0)$14" -> ".png(0)" [label = "add_test"]
"preds(0)$0" -> "learn(0)$14" [label = "TTA"]
"y(0)$0" -> "learn(0)$14" [label = "TTA"]
"preds(0)$0" -> "DatasetType(0)" [label = "TTA"]
"y(0)$0" -> "DatasetType(0)" [label = "TTA"]
"test_predictions(0)$0" -> "optR(0)$0" [label = "predict"]
"test_predictions(0)$0" -> "preds(0)$0" [label = "predict"]
"test_predictions(0)$0" -> "coefficients(0)$0" [label = "predict"]
"sample_df(0)$2" -> "sample_df(0)$1" [label = "astype"]
"sample_df(0)$2" -> "test_predictions(0)$0" [label = "astype"]
"sample_df(0)$2" -> "int(0)" [label = "astype"]
"sample_df(0)$3" -> "sample_df(0)$2" [label = "head"]
"sample_df(0)$4" -> "sample_df(0)$3" [label = "to_csv"]
"sample_df(0)$4" -> "submission.csv(0)" [label = "to_csv"]
}