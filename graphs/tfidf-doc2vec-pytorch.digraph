digraph { 
"self(2)" -> "__init__[0]" [label = "_argToVar"]
"self(3)" -> "fit_transform[0]" [label = "_argToVar"]
"df(3)" -> "fit_transform[1]" [label = "_argToVar"]
"texts(3)$0" -> "df(3)" [label = "list"]
"tagged_data(3)$0" -> "TaggedDocument(3)" [label = "eq"]
"tagged_data(3)$0" -> "word_tokenize(3)" [label = "eq"]
"tagged_data(3)$0" -> "_d(3)" [label = "eq"]
"tagged_data(3)$0" -> "[<_ast.Call object at 0x10a3d1c90>](3)" [label = "eq"]
"tagged_data(3)$0" -> "i(3)" [label = "eq"]
"tagged_data(3)$0" -> "_d(3)" [label = "eq"]
"tagged_data(3)$0" -> "enumerate(3)" [label = "eq"]
"tagged_data(3)$0" -> "texts(3)$0" [label = "eq"]
"self(3)$0" -> "self(3)" [label = "Doc2Vec"]
"self(3)$0" -> "tagged_data(3)$0" [label = "Doc2Vec"]
"self(3)$0" -> "20(3)" [label = "Doc2Vec"]
"self(3)$0" -> "30(3)" [label = "Doc2Vec"]
"feature(3)$0" -> "np(3)" [label = "array"]
"feature(3)$0" -> "self(3)$0" [label = "array"]
"feature(3)$0" -> "i(3)" [label = "array"]
"feature(3)$0" -> "i(3)" [label = "array"]
"feature(3)$0" -> "range(3)" [label = "array"]
"feature(3)$0" -> "df(3)" [label = "array"]
"feature(3)$0" -> "0(3)" [label = "array"]
"self(4)" -> "transform[0]" [label = "_argToVar"]
"df(4)" -> "transform[1]" [label = "_argToVar"]
"texts(4)$0" -> "df(4)" [label = "list"]
"words(4)$0" -> "word_tokenize(4)" [label = "eq"]
"words(4)$0" -> "texts(4)$0" [label = "eq"]
"words(4)$0" -> "i(4)" [label = "eq"]
"words(4)$0" -> "i(4)" [label = "eq"]
"words(4)$0" -> "range(4)" [label = "eq"]
"words(4)$0" -> "df(4)" [label = "eq"]
"words(4)$0" -> "0(4)" [label = "eq"]
"feature(4)$0" -> "np(4)" [label = "array"]
"feature(4)$0" -> "self(4)" [label = "array"]
"feature(4)$0" -> "words(4)$0" [label = "array"]
"feature(4)$0" -> "i(4)" [label = "array"]
"feature(4)$0" -> "30(4)" [label = "array"]
"feature(4)$0" -> "i(4)" [label = "array"]
"feature(4)$0" -> "range(4)" [label = "array"]
"feature(4)$0" -> "df(4)" [label = "array"]
"feature(4)$0" -> "0(4)" [label = "array"]
"v1(5)" -> "cos_sim[0]" [label = "_argToVar"]
"v2(5)" -> "cos_sim[1]" [label = "_argToVar"]
"train(6)$0" -> "pd(6)" [label = "read_csv"]
"train(6)$0" -> "/kaggle/input/google-quest-challenge/train.csv(6)" [label = "read_csv"]
"test(6)$0" -> "pd(6)" [label = "read_csv"]
"test(6)$0" -> "/kaggle/input/google-quest-challenge/test.csv(6)" [label = "read_csv"]
"target_cols(6)$0" -> "[<_ast.Str object at 0x10a3d6790>, <_ast.Str object at 0x10a3d6bd0>, <_ast.Str object at 0x10a3d6b90>, <_ast.Str object at 0x10a3d64d0>, <_ast.Str object at 0x10a3d6a90>, <_ast.Str object at 0x10a3d6250>, <_ast.Str object at 0x10a3d6dd0>, <_ast.Str object at 0x10a3d6e10>, <_ast.Str object at 0x10a3d6710>, <_ast.Str object at 0x10a3d6850>, <_ast.Str object at 0x10a3d6610>, <_ast.Str object at 0x10a3d6090>, <_ast.Str object at 0x10a3d6110>, <_ast.Str object at 0x10a3d61d0>, <_ast.Str object at 0x10a3d6d50>, <_ast.Str object at 0x10a3d6150>, <_ast.Str object at 0x10a3d6fd0>, <_ast.Str object at 0x10a3d6410>, <_ast.Str object at 0x10a3d63d0>, <_ast.Str object at 0x10a3d62d0>, <_ast.Str object at 0x10a3d6050>, <_ast.Str object at 0x10a3d6290>, <_ast.Str object at 0x10a3d65d0>, <_ast.Str object at 0x10a3d6210>, <_ast.Str object at 0x10a3d6510>, <_ast.Str object at 0x10a3d6190>, <_ast.Str object at 0x10a3d69d0>, <_ast.Str object at 0x10a3d6750>, <_ast.Str object at 0x10a3d6490>, <_ast.Str object at 0x10a3d6990>](6)" [label = "eq"]
"data_cols(6)$0" -> "[<_ast.Str object at 0x10a3d6550>, <_ast.Str object at 0x10a3d6650>, <_ast.Str object at 0x10a3d6690>, <_ast.Str object at 0x10a3d6810>](6)" [label = "eq"]
"y_train(6)$0" -> "train(6)$0" [label = "copy"]
"y_train(6)$0" -> "target_cols(6)$0" [label = "copy"]
"print[0]" -> "type(6)" [label = "print"]
"print[1]" -> "y_train(6)$0" [label = "print"]
"x_train(6)$0" -> "train(6)$0" [label = "copy"]
"x_train(6)$0" -> "data_cols(6)$0" [label = "copy"]
"x_test(6)$0" -> "test(6)$0" [label = "copy"]
"x_train_question_vec(6)$0" -> "question_body_doc2vec(6)" [label = "fit_transform"]
"x_train_question_vec(6)$0" -> "x_train(6)$0" [label = "fit_transform"]
"x_train_question_vec(6)$0" -> "question_body(6)" [label = "fit_transform"]
"x_test_question_vec(6)$0" -> "question_body_doc2vec(6)" [label = "transform"]
"x_test_question_vec(6)$0" -> "x_test(6)$0" [label = "transform"]
"x_test_question_vec(6)$0" -> "question_body(6)" [label = "transform"]
"x_train_answer_vec(6)$0" -> "question_body_doc2vec(6)" [label = "fit_transform"]
"x_train_answer_vec(6)$0" -> "x_train(6)$0" [label = "fit_transform"]
"x_train_answer_vec(6)$0" -> "answer(6)" [label = "fit_transform"]
"x_test_answer_vec(6)$0" -> "question_body_doc2vec(6)" [label = "transform"]
"x_test_answer_vec(6)$0" -> "x_test(6)$0" [label = "transform"]
"x_test_answer_vec(6)$0" -> "answer(6)" [label = "transform"]
"print[0]" -> "x_train_question_vec(6)$0" [label = "print"]
"text_encoder(6)$0" -> "[<_ast.Tuple object at 0x10a3da390>, <_ast.Tuple object at 0x10a3dad10>](6)" [label = "Pipeline"]
"ohe(6)$0" -> "[<_ast.Str object at 0x10a3dab90>](6)" [label = "OneHotEncoder"]
"preprocessor(6)$0" -> "[<_ast.Tuple object at 0x10a3da550>, <_ast.Tuple object at 0x10a3dae90>, <_ast.Tuple object at 0x10a3da850>, <_ast.Tuple object at 0x10a3da410>](6)" [label = "ColumnTransformer"]
"x_train(6)$1" -> "preprocessor(6)$0" [label = "astype"]
"x_train(6)$1" -> "x_train(6)$1" [label = "astype"]
"x_train(6)$1" -> "np(6)" [label = "astype"]
"x_test(6)$1" -> "preprocessor(6)$0" [label = "astype"]
"x_test(6)$1" -> "x_test(6)$1" [label = "astype"]
"x_test(6)$1" -> "np(6)" [label = "astype"]
"y_train(6)$1" -> "y_train(6)$0" [label = "astype"]
"y_train(6)$1" -> "np(6)" [label = "astype"]
"x_train(6)$2" -> "np(6)" [label = "concatenate"]
"x_train(6)$2" -> "[<_ast.Name object at 0x10a459a10>, <_ast.Name object at 0x10a459f90>, <_ast.Name object at 0x10a459650>](6)" [label = "concatenate"]
"x_train(6)$2" -> "1(6)" [label = "concatenate"]
"x_test(6)$2" -> "np(6)" [label = "concatenate"]
"x_test(6)$2" -> "[<_ast.Name object at 0x10a459e50>, <_ast.Name object at 0x10a459490>, <_ast.Name object at 0x10a459250>](6)" [label = "concatenate"]
"x_test(6)$2" -> "1(6)" [label = "concatenate"]
"prediction(7)" -> "calc_score[0]" [label = "_argToVar"]
"label(7)" -> "calc_score[1]" [label = "_argToVar"]
"score(7)$0" -> "0(7)" [label = "eq"]
"col_index(7)" -> "range(7)" [label = "Iter"]
"col_index(7)" -> "30(7)" [label = "Iter"]
"score(7)$1" -> "spearmanr(7)" [label = "Add"]
"score(7)$1" -> "score(7)$0" [label = "Add"]
"score(7)$1" -> "prediction(7)" [label = "Add"]
"score(7)$1" -> "score(7)$0" [label = "Add"]
"score(7)$1" -> "col_index(7)" [label = "Add"]
"score(7)$1" -> "score(7)$0" [label = "Add"]
"score(7)$1" -> "label(7)" [label = "Add"]
"score(7)$1" -> "score(7)$0" [label = "Add"]
"score(7)$1" -> "col_index(7)" [label = "Add"]
"score(7)$1" -> "score(7)$0" [label = "Add"]
"score(7)$1" -> "len(7)" [label = "Add"]
"score(7)$1" -> "score(7)$0" [label = "Add"]
"score(7)$1" -> "target_cols(7)" [label = "Add"]
"score(7)$1" -> "score(7)$0" [label = "Add"]
"self(9)" -> "__init__[0]" [label = "_argToVar"]
"super(9)$0" -> "super(9)" [label = "__init__"]
"self(9)$0" -> "self(9)" [label = "eq"]
"self(9)$0" -> "600(9)" [label = "eq"]
"self(9)$1" -> "self(9)$0" [label = "Linear"]
"self(9)$1" -> "345(9)" [label = "Linear"]
"self(9)$1" -> "self(9)$1" [label = "Linear"]
"self(9)$2" -> "self(9)$1" [label = "Linear"]
"self(9)$2" -> "self(9)$1" [label = "Linear"]
"self(9)$2" -> "30(9)" [label = "Linear"]
"self(10)" -> "forward[0]" [label = "_argToVar"]
"x(10)" -> "forward[1]" [label = "_argToVar"]
"x(10)$0" -> "self(10)" [label = "linear1"]
"x(10)$0" -> "x(10)$0" [label = "linear1"]
"x(10)$1" -> "self(10)" [label = "sigmoid1"]
"x(10)$1" -> "x(10)$1" [label = "sigmoid1"]
"x(10)$2" -> "self(10)" [label = "linear2"]
"x(10)$2" -> "x(10)$2" [label = "linear2"]
"self(12)" -> "__init__[0]" [label = "_argToVar"]
"data(12)" -> "__init__[1]" [label = "_argToVar"]
"label(12)" -> "__init__[2]" [label = "_argToVar"]
"device(12)" -> "__init__[3]" [label = "_argToVar"]
"transform(12)" -> "__init__[4]" [label = "_argToVar"]
"self(12)$0" -> "self(12)" [label = "eq"]
"self(12)$0" -> "transform(12)" [label = "eq"]
"self(12)$1" -> "self(12)$0" [label = "to"]
"self(12)$1" -> "torch(12)" [label = "to"]
"self(12)$1" -> "data(12)" [label = "to"]
"self(12)$1" -> "device(12)" [label = "to"]
"self(12)$2" -> "self(12)$1" [label = "to"]
"self(12)$2" -> "torch(12)" [label = "to"]
"self(12)$2" -> "label(12)" [label = "to"]
"self(12)$2" -> "device(12)" [label = "to"]
"self(12)$3" -> "self(12)$2" [label = "eq"]
"self(12)$3" -> "self(12)$2" [label = "eq"]
"self(12)$3" -> "0(12)" [label = "eq"]
"self(13)" -> "__len__[0]" [label = "_argToVar"]
"self(14)" -> "__getitem__[0]" [label = "_argToVar"]
"idx(14)" -> "__getitem__[1]" [label = "_argToVar"]
"out_data(14)$0" -> "self(14)" [label = "eq"]
"out_data(14)$0" -> "idx(14)" [label = "eq"]
"out_label(14)$0" -> "self(14)" [label = "eq"]
"out_label(14)$0" -> "idx(14)" [label = "eq"]
"self(15)" -> "get_numpy_label[0]" [label = "_argToVar"]
"self(17)" -> "__init__[0]" [label = "_argToVar"]
"data(17)" -> "__init__[1]" [label = "_argToVar"]
"device(17)" -> "__init__[2]" [label = "_argToVar"]
"transform(17)" -> "__init__[3]" [label = "_argToVar"]
"self(17)$0" -> "self(17)" [label = "eq"]
"self(17)$0" -> "transform(17)" [label = "eq"]
"self(17)$1" -> "self(17)$0" [label = "to"]
"self(17)$1" -> "torch(17)" [label = "to"]
"self(17)$1" -> "data(17)" [label = "to"]
"self(17)$1" -> "device(17)" [label = "to"]
"self(17)$2" -> "self(17)$1" [label = "eq"]
"self(17)$2" -> "self(17)$1" [label = "eq"]
"self(17)$2" -> "0(17)" [label = "eq"]
"self(18)" -> "__len__[0]" [label = "_argToVar"]
"self(19)" -> "__getitem__[0]" [label = "_argToVar"]
"idx(19)" -> "__getitem__[1]" [label = "_argToVar"]
"out_data(19)$0" -> "self(19)" [label = "eq"]
"out_data(19)$0" -> "idx(19)" [label = "eq"]
"device(0)$0" -> "cuda(0)" [label = "eq"]
"device(0)$1" -> "cpu(0)" [label = "eq"]
"dataset(0)$0" -> "train_data(0)" [label = "MyDataset"]
"dataset(0)$0" -> "train_label(0)" [label = "MyDataset"]
"dataset(0)$0" -> "device(0)$1" [label = "MyDataset"]
"test_dataset(0)$0" -> "test_data(0)" [label = "TestDataset"]
"test_dataset(0)$0" -> "device(0)$1" [label = "TestDataset"]
"train_size(0)$0" -> "len(0)" [label = "int"]
"train_size(0)$0" -> "dataset(0)$0" [label = "int"]
"train_size(0)$0" -> "1.0(0)" [label = "int"]
"val_size(0)$0" -> "len(0)" [label = "Sub"]
"val_size(0)$0" -> "dataset(0)$0" [label = "Sub"]
"val_size(0)$0" -> "train_size(0)$0" [label = "Sub"]
"train_dataset(0)$0" -> "torch(0)" [label = "random_split"]
"val_dataset(0)$0" -> "torch(0)" [label = "random_split"]
"train_dataset(0)$0" -> "dataset(0)$0" [label = "random_split"]
"val_dataset(0)$0" -> "dataset(0)$0" [label = "random_split"]
"train_dataset(0)$0" -> "[<_ast.Name object at 0x10a17d990>, <_ast.Name object at 0x10a17d750>](0)" [label = "random_split"]
"val_dataset(0)$0" -> "[<_ast.Name object at 0x10a17d990>, <_ast.Name object at 0x10a17d750>](0)" [label = "random_split"]
"train_dataloader(0)$0" -> "train_dataset(0)$0" [label = "DataLoader"]
"train_dataloader(0)$0" -> "20(0)" [label = "DataLoader"]
"model(0)$0" -> "Net(0)" [label = "to"]
"model(0)$0" -> "device(0)$1" [label = "to"]
"epoch_size(0)$0" -> "100(0)" [label = "eq"]
"optimizer(0)$0" -> "model(0)$0" [label = "Adam"]
"optimizer(0)$0" -> "1e-05(0)" [label = "Adam"]
"loss_list(0)$0" -> "np(0)" [label = "zeros"]
"loss_list(0)$0" -> "epoch_size(0)$0" [label = "zeros"]
"epoch(0)" -> "range(0)" [label = "Iter"]
"epoch(0)" -> "epoch_size(0)$0" [label = "Iter"]
"n_batch(0)" -> "enumerate(0)" [label = "Iter"]
"data_batched(0)" -> "enumerate(0)" [label = "Iter"]
"n_batch(0)" -> "train_dataloader(0)$0" [label = "Iter"]
"data_batched(0)" -> "train_dataloader(0)$0" [label = "Iter"]
"data(0)$0" -> "data_batched(0)" [label = "eq"]
"label(0)$0" -> "data_batched(0)" [label = "eq"]
"optimizer(0)$1" -> "optimizer(0)$0" [label = "zero_grad"]
"output(0)$0" -> "data(0)$0" [label = "model"]
"loss(0)$0" -> "output(0)$0" [label = "criterion"]
"loss(0)$0" -> "label(0)$0" [label = "criterion"]
"loss(0)$1" -> "loss(0)$0" [label = "backward"]
"optimizer(0)$2" -> "optimizer(0)$1" [label = "step"]
"tmp(0)$0" -> "loss(0)$1" [label = "cpu"]
"loss_list(0)$1" -> "tmp(0)$0" [label = "Add"]
"loss_list(0)$1" -> "loss_list(0)$0" [label = "Add"]
"loss_list(0)$2" -> "n_batch(0)" [label = "Div"]
"loss_list(0)$2" -> "loss_list(0)$1" [label = "Div"]
"print[0]" -> "epoch(0)" [label = "print"]
"print[1]" -> ", loss is (0)" [label = "print"]
"print[2]" -> "loss_list(0)$2" [label = "print"]
"print[3]" -> "epoch(0)" [label = "print"]
"plt(0)$0" -> "plt(0)" [label = "plot"]
"plt(0)$0" -> "loss_list(0)$2" [label = "plot"]
"plt(0)$1" -> "plt(0)$0" [label = "show"]
"target_cols(0)$0" -> "[<_ast.Str object at 0x10a9b9990>, <_ast.Str object at 0x10a9b9450>, <_ast.Str object at 0x10a9b95d0>, <_ast.Str object at 0x10a9b9a10>, <_ast.Str object at 0x10a9b9490>, <_ast.Str object at 0x10a9b9a90>, <_ast.Str object at 0x10a9b9fd0>, <_ast.Str object at 0x10a9b9f50>, <_ast.Str object at 0x10a9b9b10>, <_ast.Str object at 0x10a9b9810>, <_ast.Str object at 0x10a9b9750>, <_ast.Str object at 0x10a9b9910>, <_ast.Str object at 0x10a9b9dd0>, <_ast.Str object at 0x10a9b9590>, <_ast.Str object at 0x10a9b9c10>, <_ast.Str object at 0x10a9b9150>, <_ast.Str object at 0x10a9b9f90>, <_ast.Str object at 0x10a9b9ed0>, <_ast.Str object at 0x10a9b9790>, <_ast.Str object at 0x10a9b9410>, <_ast.Str object at 0x10a9b99d0>, <_ast.Str object at 0x10a9b9e90>, <_ast.Str object at 0x10a9b9850>, <_ast.Str object at 0x10a9b9bd0>, <_ast.Str object at 0x10a9b9d90>, <_ast.Str object at 0x10a9b9690>, <_ast.Str object at 0x10a9b9a50>, <_ast.Str object at 0x10a9b9b50>, <_ast.Str object at 0x10a9b9550>, <_ast.Str object at 0x10a9b9e10>](0)" [label = "eq"]
"train_prediction(0)$0" -> "np(0)" [label = "zeros"]
"train_prediction(0)$0" -> "len(0)" [label = "zeros"]
"train_prediction(0)$0" -> "train_dataset(0)$0" [label = "zeros"]
"train_prediction(0)$0" -> "30(0)" [label = "zeros"]
"model(0)$1" -> "model(0)$0" [label = "eval"]
"i(0)" -> "enumerate(0)" [label = "Iter"]
"data(0)$0" -> "enumerate(0)" [label = "Iter"]
"i(0)" -> "train_dataset(0)$0" [label = "Iter"]
"data(0)$0" -> "train_dataset(0)$0" [label = "Iter"]
"input(0)$0" -> "data(0)$0" [label = "eq"]
"label(0)$1" -> "data(0)$0" [label = "eq"]
"output(0)$1" -> "input(0)$0" [label = "model"]
"train_prediction(0)$1" -> "train_prediction(0)$0" [label = "numpy"]
"train_prediction(0)$1" -> "output(0)$1" [label = "numpy"]
"train_prediction(0)$2" -> "train_prediction(0)$1" [label = "eq"]
"print[0]" -> "training score is (0)" [label = "print"]
"print[1]" -> "calc_score(0)" [label = "print"]
"print[2]" -> "train_prediction(0)$2" [label = "print"]
"print[3]" -> "train_dataset(0)$0" [label = "print"]
"val_prediction(0)$0" -> "np(0)" [label = "zeros"]
"val_prediction(0)$0" -> "len(0)" [label = "zeros"]
"val_prediction(0)$0" -> "val_dataset(0)$0" [label = "zeros"]
"val_prediction(0)$0" -> "30(0)" [label = "zeros"]
"model(0)$2" -> "model(0)$1" [label = "eval"]
"i(0)" -> "enumerate(0)" [label = "Iter"]
"data(0)$0" -> "enumerate(0)" [label = "Iter"]
"i(0)" -> "val_dataset(0)$0" [label = "Iter"]
"data(0)$0" -> "val_dataset(0)$0" [label = "Iter"]
"input(0)$1" -> "data(0)$0" [label = "eq"]
"label(0)$2" -> "data(0)$0" [label = "eq"]
"output(0)$2" -> "input(0)$1" [label = "model"]
"val_prediction(0)$1" -> "val_prediction(0)$0" [label = "numpy"]
"val_prediction(0)$1" -> "output(0)$2" [label = "numpy"]
"val_prediction(0)$2" -> "val_prediction(0)$1" [label = "eq"]
"print[0]" -> "validation score is (0)" [label = "print"]
"print[1]" -> "calc_score(0)" [label = "print"]
"print[2]" -> "val_prediction(0)$2" [label = "print"]
"print[3]" -> "val_dataset(0)$0" [label = "print"]
"prediction(0)$0" -> "np(0)" [label = "zeros"]
"prediction(0)$0" -> "len(0)" [label = "zeros"]
"prediction(0)$0" -> "test_dataset(0)$0" [label = "zeros"]
"prediction(0)$0" -> "30(0)" [label = "zeros"]
"model(0)$3" -> "model(0)$2" [label = "eval"]
"i(0)" -> "enumerate(0)" [label = "Iter"]
"data(0)$0" -> "enumerate(0)" [label = "Iter"]
"i(0)" -> "test_dataset(0)$0" [label = "Iter"]
"data(0)$0" -> "test_dataset(0)$0" [label = "Iter"]
"output(0)$3" -> "data(0)$0" [label = "model"]
"prediction(0)$1" -> "prediction(0)$0" [label = "numpy"]
"prediction(0)$1" -> "output(0)$3" [label = "numpy"]
"sample(0)$0" -> "pd(0)" [label = "read_csv"]
"sample(0)$0" -> "/kaggle/input/google-quest-challenge/sample_submission.csv(0)" [label = "read_csv"]
"prediction(0)$2" -> "prediction(0)$1" [label = "eq"]
"prediction(0)$3" -> "np(0)" [label = "clip"]
"prediction(0)$3" -> "prediction(0)$3" [label = "clip"]
"prediction(0)$3" -> "0.0(0)" [label = "clip"]
"prediction(0)$3" -> "1.0(0)" [label = "clip"]
"i(0)" -> "range(0)" [label = "Iter"]
"i(0)" -> "30(0)" [label = "Iter"]
"sample(0)$1" -> "sample(0)$0" [label = "eq"]
"sample(0)$1" -> "prediction(0)$3" [label = "eq"]
"sample(0)$1" -> "i(0)" [label = "eq"]
"sample(0)$2" -> "sample(0)$1" [label = "to_csv"]
"sample(0)$2" -> "submission.csv(0)" [label = "to_csv"]
"sample(0)$3" -> "sample(0)$2" [label = "head"]
"df(0)$0" -> "pd(0)" [label = "read_csv"]
"df(0)$0" -> "/kaggle/input/google-quest-challenge/train.csv(0)" [label = "read_csv"]
"df(0)$1" -> "df(0)$0" [label = "head"]
}